<!--
Nonprofit Social Networking Platform: Allowing Users and Organizations to Collaborate.
Copyright (C) 2023  ASCENDynamics NFP

This file is part of Nonprofit Social Networking Platform.

Nonprofit Social Networking Platform is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published
by the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Nonprofit Social Networking Platform is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with Nonprofit Social Networking Platform.  If not, see <https://www.gnu.org/licenses/>.
-->
<ion-card class="contact-info-card" *ngIf="isOwnerOrAdmin || resolvedContactInfo">
  <ion-card-header>
    <div class="title-with-privacy">
      <ion-card-title>Contact Information</ion-card-title>
      <ion-chip
        *ngIf="isOwnerOrAdmin"
        [color]="contactInfoPrivacyData.color"
        size="small"
        class="privacy-indicator"
      >
        <ion-icon
          [name]="
            contactInfoPrivacyData.visibility === 'public'
              ? 'globe'
              : 'lock-closed'
          "
          size="small"
        ></ion-icon>
        <ion-label>{{ contactInfoPrivacyData.label }}</ion-label>
      </ion-chip>
    </div>
  </ion-card-header>
  <ion-card-content>
    <ion-grid>
      <ion-row>
        <ion-col size="6">
          <div
            class="info-block"
            *ngIf="resolvedContactInfo as _; else contactInfoPrivate"
          >
            <div class="info-block">
              <h2>
                Phone
                <ion-button
                  *ngIf="hasMoreThanOnePhoneNumber"
                  fill="clear"
                  size="small"
                  (click)="toggleShow('phone')"
                >
                  {{ showMore.phone ? "Hide" : "Show" }} More
                </ion-button>
              </h2>
              <p>{{ getFirstPhoneNumber() }}</p>
              <div *ngIf="showMore.phone">
                <p *ngFor="let phone of otherPhoneNumbers">
                  {{ formatPhoneNumber(phone) }}
                </p>
              </div>
            </div>
            <div class="info-block">
              <h2>
                Email Address
                <ion-button
                  *ngIf="hasMoreThanOneEmail"
                  fill="clear"
                  size="small"
                  (click)="toggleShow('email')"
                >
                  {{ showMore.email ? "Hide" : "Show" }} More
                </ion-button>
              </h2>
              <p>{{ getFirstEmail() }}</p>
              <div *ngIf="showMore.email">
                <p *ngFor="let email of otherEmails">
                  {{ formatEmail(email) }}
                </p>
              </div>
            </div>
            <div class="info-block">
              <h2>
                Mailing Address
                <ion-button
                  *ngIf="hasMoreThanOneAddress"
                  fill="clear"
                  size="small"
                  (click)="toggleShow('address')"
                >
                  {{ showMore.address ? "Hide" : "Show" }} More
                </ion-button>
              </h2>
              <p [innerText]="getFirstAddress()"></p>
              <div *ngIf="showMore.address">
                <p
                  *ngFor="let address of otherAddresses"
                  [innerText]="address ? formatAddress(address) : '-'"
                ></p>
              </div>
            </div>
          </div>
        </ion-col>
        <ion-col size="6">
          <div class="info-block">
            <h2>Preferred Method of Contact</h2>
            <p>{{ preferredMethodOfContact }}</p>
          </div>

          <!-- Supported Languages for groups -->
          <div
            class="info-block"
            *ngIf="
              account?.type === 'group' &&
              account?.groupDetails?.supportedLanguages?.length
            "
          >
            <h2>Supported Languages</h2>
            <p>{{ account?.groupDetails?.supportedLanguages?.join(", ") }}</p>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-card-content>
</ion-card>

<ng-template #contactInfoPrivate>
  <div class="info-block">
    <ion-text color="medium">
      <ng-container *ngIf="isOwnerOrAdmin; else notOwner">
        No contact information has been added yet.
      </ng-container>
      <ng-template #notOwner>
        Contact information is private or unavailable.
      </ng-template>
    </ion-text>
  </div>
  <!-- TODO: Add CTA to request access in future iteration -->
</ng-template>
