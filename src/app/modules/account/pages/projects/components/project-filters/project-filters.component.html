<div class="project-filters">
  <!-- Main Filter Row -->
  <div class="main-filter-row">
    <!-- Search -->
    <div class="search-section">
      <ion-searchbar
        [(ngModel)]="searchTerm"
        (ionInput)="onSearchChange($event.detail.value!)"
        placeholder="Search projects..."
        showClearButton="focus"
        debounce="300"
      ></ion-searchbar>
    </div>

    <!-- Category & Sort Controls -->
    <div class="controls-section">
      <!-- Category Filter -->
      <ion-select
        [(ngModel)]="selectedCategory"
        (ionSelectionChange)="onCategoryFilterChange($any($event).detail.value)"
        placeholder="All Categories"
        interface="popover"
        class="category-select"
      >
        <ion-select-option value="all">All Categories</ion-select-option>
        <ion-select-option
          *ngFor="let category of categoryKeys"
          [value]="category"
        >
          {{ category }}
        </ion-select-option>
      </ion-select>

      <!-- Sort Controls -->
      <div class="sort-controls">
        <ion-segment [(ngModel)]="sortBy" class="sort-segment">
          <ion-segment-button value="name" (click)="onSortButtonClick('name')">
            <ion-label>Name</ion-label>
            <ion-icon
              [name]="getSortIcon()"
              slot="end"
              [style.visibility]="sortBy === 'name' ? 'visible' : 'hidden'"
            ></ion-icon>
          </ion-segment-button>
          <ion-segment-button value="category" (click)="onSortButtonClick('category')">
            <ion-label>Category</ion-label>
            <ion-icon
              [name]="getSortIcon()"
              slot="end"
              [style.visibility]="sortBy === 'category' ? 'visible' : 'hidden'"
            ></ion-icon>
          </ion-segment-button>
          <ion-segment-button value="created" (click)="onSortButtonClick('created')">
            <ion-label>Created</ion-label>
            <ion-icon
              [name]="getSortIcon()"
              slot="end"
              [style.visibility]="sortBy === 'created' ? 'visible' : 'hidden'"
            ></ion-icon>
          </ion-segment-button>
        </ion-segment>
      </div>
    </div>
  </div>

  <!-- Secondary Actions Row -->
  <div class="actions-row">
    <!-- Toggle Controls -->
    <div class="toggle-controls">
      <ion-button
        [fill]="groupByCategory ? 'solid' : 'outline'"
        [color]="groupByCategory ? 'primary' : 'medium'"
        size="small"
        (click)="onGroupByCategoryToggle()"
        class="toggle-btn"
      >
        <ion-icon
          [name]="groupByCategory ? 'checkmark-circle' : 'albums-outline'"
          slot="start"
        ></ion-icon>
        Group
      </ion-button>
    </div>

    <!-- Status & Actions -->
    <div class="status-actions">
      <ion-badge color="primary" class="project-count">
        {{ projectCount }} projects
      </ion-badge>

      <ion-button
        *ngIf="hasActiveFilters()"
        fill="clear"
        size="small"
        color="medium"
        (click)="clearFilters()"
        class="clear-btn"
      >
        <ion-icon name="close-circle" slot="start"></ion-icon>
        Clear
      </ion-button>

    </div>
  </div>
</div>
