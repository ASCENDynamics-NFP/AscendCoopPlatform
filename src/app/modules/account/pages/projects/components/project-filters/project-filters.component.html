<div class="project-filters">
  <!-- Main Filter Row -->
  <div class="main-filter-row">
    <!-- Search -->
    <div class="search-section">
      <ion-searchbar
        [(ngModel)]="searchTerm"
        (ionInput)="onSearchChange($event.detail.value!)"
        placeholder="Search projects..."
        showClearButton="focus"
        debounce="300"
      ></ion-searchbar>
    </div>

    <!-- Category & Sort Controls -->
    <div class="controls-section">
      <!-- Category Filter -->
      <ion-select
        [(ngModel)]="selectedCategory"
        (ionSelectionChange)="onCategoryFilterChange($any($event).detail.value)"
        placeholder="All Categories"
        interface="popover"
        class="category-select"
      >
        <ion-select-option value="all">All Categories</ion-select-option>
        <ion-select-option
          *ngFor="let category of categoryKeys"
          [value]="category"
        >
          {{ category }}
        </ion-select-option>
      </ion-select>

      <!-- Sort Controls -->
      <div class="sort-controls">
        <ion-segment
          [(ngModel)]="sortBy"
          (ionChange)="onSortChange($any($event).detail.value)"
          class="sort-segment"
        >
          <ion-segment-button value="name">Name</ion-segment-button>
          <ion-segment-button value="category">Category</ion-segment-button>
          <ion-segment-button value="created">Created</ion-segment-button>
        </ion-segment>

        <ion-button
          fill="clear"
          size="small"
          (click)="onSortDirectionToggle()"
          class="sort-direction-btn"
        >
          <ion-icon [name]="getSortIcon()" slot="icon-only"></ion-icon>
        </ion-button>
      </div>
    </div>
  </div>

  <!-- Secondary Actions Row -->
  <div class="actions-row">
    <!-- Toggle Controls -->
    <div class="toggle-controls">
      <ion-button
        [fill]="groupByCategory ? 'solid' : 'outline'"
        [color]="groupByCategory ? 'primary' : 'medium'"
        size="small"
        (click)="onGroupByCategoryToggle()"
        class="toggle-btn"
      >
        <ion-icon
          [name]="groupByCategory ? 'checkmark-circle' : 'albums-outline'"
          slot="start"
        ></ion-icon>
        Group
      </ion-button>

      <ion-button
        [fill]="showCategoryOverview ? 'solid' : 'outline'"
        [color]="showCategoryOverview ? 'primary' : 'medium'"
        size="small"
        (click)="onToggleCategoryOverview()"
        class="toggle-btn"
      >
        <ion-icon
          [name]="
            showCategoryOverview ? 'checkmark-circle' : 'analytics-outline'
          "
          slot="start"
        ></ion-icon>
        Analytics
      </ion-button>
    </div>

    <!-- Status & Actions -->
    <div class="status-actions">
      <ion-badge color="primary" class="project-count">
        {{ projectCount }} projects
      </ion-badge>

      <ion-button
        *ngIf="hasActiveFilters()"
        fill="clear"
        size="small"
        color="medium"
        (click)="clearFilters()"
        class="clear-btn"
      >
        <ion-icon name="close-circle" slot="start"></ion-icon>
        Clear
      </ion-button>
    </div>
  </div>
</div>
