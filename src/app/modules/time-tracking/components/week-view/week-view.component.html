<h2>Week of {{ weekStart | date: 'MMM d' }}</h2>
<button (click)="addRow()">Add Row</button>

<table class="week-grid">
  <thead>
    <tr>
      <th>Project</th>
      <th *ngFor="let day of days">{{ day | date: "EEE MM/dd" }}</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let row of rows; let i = index">
      <td>
        <ng-container *ngIf="availableProjects.length > 1; else single">
          <select [value]="row.projectId" (change)="addProjectById(i, $event)">
            <option value="">Select...</option>
            <option
              *ngFor="let proj of availableProjects"
              [value]="proj.id"
              [disabled]="isSelected(proj.id, i)"
            >
              {{ proj.name }}
            </option>
          </select>
        </ng-container>
        <ng-template #single>
          {{ availableProjects.length > 0 ? availableProjects[0].name : '' }}
        </ng-template>
        <button (click)="removeRow(i)">Remove</button>
      </td>
      <td *ngFor="let day of days">
        <input
          type="number"
          [value]="row.projectId ? getEntry(row.projectId, day)?.hours : ''"
          (change)="onHoursChange(i, day, $event)"
          [disabled]="!row.projectId"
        />
      </td>
      <td>{{ rowTotals[i] || 0 }}</td>
    </tr>
  </tbody>
  <tfoot>
    <tr>
      <td>Total</td>
      <td *ngFor="let total of columnTotals">{{ total }}</td>
      <td>{{ totalHours }}</td>
    </tr>
  </tfoot>
</table>
