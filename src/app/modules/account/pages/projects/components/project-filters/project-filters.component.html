<div class="project-filters">
  <!-- Search and Basic Controls -->
  <div class="filters-header">
    <div class="search-container">
      <ion-searchbar
        [(ngModel)]="searchTerm"
        (ionInput)="onSearchChange($event.detail.value!)"
        placeholder="Search projects..."
        showClearButton="focus"
        debounce="300"
      ></ion-searchbar>
    </div>

    <div class="filter-controls">
      <!-- Category Filter -->
      <ion-item lines="none" class="category-filter">
        <ion-label position="stacked">Filter by Category</ion-label>
        <ion-select
          [(ngModel)]="selectedCategory"
          (ionSelectionChange)="
            onCategoryFilterChange($any($event).detail.value)
          "
          placeholder="All Categories"
          interface="popover"
        >
          <ion-select-option value="all">All Categories</ion-select-option>
          <ion-select-option
            *ngFor="let category of categoryKeys"
            [value]="category"
          >
            <ion-icon
              [name]="projectCategories[category].icon"
              [style.color]="projectCategories[category].color"
              class="category-icon"
            ></ion-icon>
            {{ category }}
          </ion-select-option>
        </ion-select>
      </ion-item>

      <!-- Sort Controls -->
      <ion-item lines="none" class="sort-controls">
        <ion-label position="stacked">Sort By</ion-label>
        <div class="sort-buttons">
          <ion-segment
            [(ngModel)]="sortBy"
            (ionChange)="onSortChange($any($event).detail.value)"
            class="sort-segment"
          >
            <ion-segment-button value="name">
              <ion-label>Name</ion-label>
            </ion-segment-button>
            <ion-segment-button value="category">
              <ion-label>Category</ion-label>
            </ion-segment-button>
            <ion-segment-button value="created">
              <ion-label>Created</ion-label>
            </ion-segment-button>
          </ion-segment>

          <ion-button
            fill="clear"
            size="small"
            (click)="onSortDirectionToggle()"
            class="sort-direction-btn"
          >
            <ion-icon [name]="getSortIcon()" slot="icon-only"></ion-icon>
          </ion-button>
        </div>
      </ion-item>
    </div>
  </div>

  <!-- Advanced Controls -->
  <div class="advanced-controls">
    <div class="toggle-controls">
      <!-- Group by Category Toggle -->
      <ion-item lines="none" class="toggle-item">
        <ion-checkbox
          [(ngModel)]="groupByCategory"
          (ionChange)="onGroupByCategoryToggle()"
          slot="start"
        ></ion-checkbox>
        <ion-label>
          <h3>Group by Category</h3>
          <p>Organize projects into category sections</p>
        </ion-label>
      </ion-item>

      <!-- Category Overview Toggle -->
      <ion-item lines="none" class="toggle-item">
        <ion-checkbox
          [checked]="showCategoryOverview"
          (ionChange)="onToggleCategoryOverview()"
          slot="start"
        ></ion-checkbox>
        <ion-label>
          <h3>Category Overview</h3>
          <p>Show category statistics and analytics</p>
        </ion-label>
      </ion-item>
    </div>

    <!-- Filter Status and Actions -->
    <div class="filter-status">
      <div class="project-count">
        <ion-badge color="primary">{{ projectCount }} projects</ion-badge>
      </div>

      <ion-button
        *ngIf="hasActiveFilters()"
        fill="clear"
        size="small"
        color="medium"
        (click)="clearFilters()"
        class="clear-filters-btn"
      >
        <ion-icon name="close-circle" slot="start"></ion-icon>
        Clear Filters
      </ion-button>
    </div>
  </div>
</div>
